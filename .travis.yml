dist: trusty
sudo: true

language: node_js
node_js:
  - '12'

cache:
  directories:
    - ./node_modules

services:
    - docker

jobs:
    include:
       - stage: build docker image
         script:
          - 'if [ "${TRAVIS_PULL_REQUEST}" = "false" ];
          then chmod +x test.sh;
                     ./ test.sh;
          fi'
       - stage: lint
         if: branch = master OR branch = dev
         script: npm run lint


       - stage: build  
         if: branch = master OR branch = dev
         script: npm run build

deploy:
    provider: gae
    project: airy-ceremony-274018  
    keyfile: airy-ceremony-274018-a8e7ff162b93.json
    verbosity: debug
    on: master      

